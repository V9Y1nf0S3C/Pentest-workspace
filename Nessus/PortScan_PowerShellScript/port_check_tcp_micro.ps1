$ipW = Get-Content "windows.txt"; $ipL = Get-Content "linux.txt"; $O = "output.txt" ;$pW = @(445, 139, 135); $pL = @(22); foreach ($H in $ipW) {  Write-Host "`nTesting the Windows Host: $H"; foreach ($P in $pW) {$tcpClient = New-Object System.Net.Sockets.TcpClient; try {$result = $tcpClient.BeginConnect($H, $P, $null, $null); $wait = $result.AsyncWaitHandle.WaitOne(1000, $false); if ($wait) {"$H`t$P`topen" | Tee-Object -FilePath $O -Append} else {"$H`t$P`tclosed" | Tee-Object -FilePath $O -Append}} catch {"$H`t$P`tclosed" | Tee-Object -FilePath $O -Append} finally {$tcpClient.Close()}}}; foreach ($H in $ipL) {  Write-Host "`nTesting the Linux Host: $H"; foreach ($P in $pL) {$tcpClient = New-Object System.Net.Sockets.TcpClient; try {$result = $tcpClient.BeginConnect($H, $P, $null, $null); $wait = $result.AsyncWaitHandle.WaitOne(1000, $false); if ($wait) {"$H`t$P`topen" | Tee-Object -FilePath $O -Append} else {"$H`t$P`tclosed" | Tee-Object -FilePath $O -Append}} catch {"$H`t$P`tclosed" | Tee-Object -FilePath $O -Append} finally {$tcpClient.Close()}}}