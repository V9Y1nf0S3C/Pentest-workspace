metadata:
    language: v2-beta
    name: "V9Y - robots.txt found"
    description: "Test for robots.txt file"
    author: "Vinaya Kumar"

run for each:
    potential_path = "/robots.txt"

given host then
    send request called check:
        method: "GET"
        path: {potential_path}

    if "200" in {check.response.status_code} then
        report issue:
            severity: info
            confidence: certain
            detail: `{potential_path} found. \n\nNote: This information can be used in host enumeration`
            remediation: "Ensure the sensitive content is not present in the files."
	    else if "301" in {check.response.status_code} then 
	        report issue:
	            severity: info
	            confidence: tentative
	            detail: `{potential_path} found. \n\nNote: This information can be used in host enumeration`
	            remediation: "Ensure the sensitive content is not present in the files."
    end if
