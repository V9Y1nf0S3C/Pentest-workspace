metadata:
    language: v2-beta
    name: "V9Y - JWT | Server's public key found - /.well-known/jwks.json"
    description: "Test for JWT Public Keys"
    author: "Vinaya Kumar"

run for each:
    potential_path = "/.well-known/jwks.json"

given host then
    send request called check:
        method: "GET"
        path: {potential_path}

    if "200" in {check.response.status_code} then
        report issue:
            severity: info
            confidence: certain
            detail: `{potential_path} found. \n\nNote: This information can be used in JWT - Algorithm confusion attack`
            remediation: "Check if server is vulnerable to Algorithm confusion attack. If vulnerable, implement strict validaions of either RS256 or HS256 but not both."
	    else if "301" in {check.response.status_code} then 
	        report issue:
	            severity: info
	            confidence: tentative
	            detail: `{potential_path} found. \n\nNote: This information can be used in JWT - Algorithm confusion attack`
	            remediation: "Check if server is vulnerable to Algorithm confusion attack. If vulnerable, implement strict validaions of either RS256 or HS256 but not both."
    end if
