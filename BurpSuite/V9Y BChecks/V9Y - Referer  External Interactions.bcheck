metadata:
    language: v2-beta
    name: "V9Y - Referer | External Interactions"
    description: "Test for Referer header"
    author: "Vinaya Kumar"

run for each:
    potential_path = `v9y{random_str(5)}.{generate_collaborator_address()}`

given request then
    send request:
        headers:
            "Referer": {potential_path}

    if dns interactions then
        report issue:
            severity: low
            confidence: certain
            detail: "DNS interaction found for the URL provided in Referer header."
    end if


    if smtp interactions then
        report issue:
            severity: medium
            confidence: certain
            detail: "SMTP interaction found for the URL provided in Referer header."
    end if

    if http interactions then
        report issue:
            severity: high
            confidence: certain
            detail: "HTTP interaction found for the URL provided in Referer header."
    end if
